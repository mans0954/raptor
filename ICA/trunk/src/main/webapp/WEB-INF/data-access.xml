<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
	http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<!--  List all the data access beans, used by the parser -->
	<bean id="dataAccessRegister" class="main.uk.ac.cf.engine.DataAccessRegister">
		<property name="authenticationModules">
			<list>
				<bean id="shibbolethLFP" class="main.uk.ac.cf.dao.external.file.LogFileParser">
					<property name="logfile">
						<value>file:///tmp/idp-access.log
						</value>
					</property>
					<property name="format">
						<ref bean="shibIDPAccessFileFormat" />
					</property>
				</bean>
			</list>
		</property>
	</bean>


	<!--
		definition of the log file format, where some standard log file
		formats will be specified here e.g. shib-access, W3C, apache, EZProxy
		etc IMPORTANT, the headers must be a match for the internal model at
		the moment
	-->

	<!-- accepted types are DATE, STRING, INTEGER -->

	<bean id="shibIDPAccessFileFormat" class="main.uk.ac.cf.dao.external.format.LogFileFormat" >
		<property name="headers">
			<list>
				<bean class="main.uk.ac.cf.dao.external.format.Header">
					<property name="fieldName"><value>eventTime</value></property>
					<property name="fieldNo"><value>0</value></property>
					<property name="fieldType"><value>DATE</value></property>
					<property name="dateTimeFormat"><value>yyyyMMdd'T'HHmmss</value></property> <!--  Atom (ISO 8601) -->
				</bean>
				<bean class="main.uk.ac.cf.dao.external.format.Header">
					<property name="fieldName"><value>requestHost</value></property>
					<property name="fieldNo"><value>1</value></property>
					<property name="fieldType"><value>STRING</value></property>
				</bean>
				<bean class="main.uk.ac.cf.dao.external.format.Header">
					<property name="fieldName"><value>serverHost</value></property>
					<property name="fieldNo"><value>2</value></property>
					<property name="fieldType"><value>STRING</value></property>
				</bean>
				<bean class="main.uk.ac.cf.dao.external.format.Header">
					<property name="fieldName"><value>requestPath</value></property>
					<property name="fieldNo"><value>3</value></property>
					<property name="fieldType"><value>STRING</value></property>
				</bean>
			</list>
		</property>
		<property name="delimeter">
			<value>|</value>
		</property>
	</bean>

	<bean id="shibIDPAuditFileFormat" class="main.uk.ac.cf.dao.external.format.LogFileFormat"></bean>

	<bean id="EZProxyFileFormat" class="main.uk.ac.cf.dao.external.format.LogFileFormat"></bean>

	<bean id="W3CFileFormat" class="main.uk.ac.cf.dao.external.format.LogFileFormat"></bean>


</beans>
